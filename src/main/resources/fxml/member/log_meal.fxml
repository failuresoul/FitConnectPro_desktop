<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<ScrollPane xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.gym.controllers.member.LogMealController"
            fitToWidth="true" style="-fx-background: transparent; -fx-background-color: transparent;">

    <VBox spacing="20" style="-fx-background-color: linear-gradient(to bottom, #f8f9fa, #e9ecef); -fx-padding: 25;">

        <!-- Header -->
        <HBox alignment="CENTER_LEFT" spacing="15" style="-fx-background-color: white; -fx-padding: 15; -fx-background-radius: 10; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 10, 0, 0, 2);">
            <Button fx:id="backButton" text="â† Back" onAction="#handleBack" style="-fx-background-color: #ecf0f1; -fx-text-fill: #2c3e50; -fx-font-size: 13px; -fx-font-weight: bold; -fx-padding: 8 15; -fx-background-radius: 5; -fx-cursor: hand;">
                <cursor><javafx.scene.Cursor fx:constant="HAND"/></cursor>
            </Button>
            <Separator orientation="VERTICAL"/>
            <Label text="ðŸ¥— Log Meal" style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: #2c3e50;"/>
        </HBox>

        <!-- Meal Details -->
        <VBox spacing="15" style="-fx-background-color: white; -fx-padding: 20; -fx-background-radius: 10; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 10, 0, 0, 2);">
            <Label text="Meal Details" style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #2c3e50;"/>
            <HBox spacing="15">
                <VBox spacing="5" HBox.hgrow="ALWAYS">
                    <Label text="Meal Type" style="-fx-font-size: 12px; -fx-text-fill: #7f8c8d;"/>
                    <ComboBox fx:id="mealTypeComboBox" maxWidth="Infinity" promptText="Select meal type"/>
                </VBox>
                <VBox spacing="5" HBox.hgrow="ALWAYS">
                    <Label text="Meal Time" style="-fx-font-size: 12px; -fx-text-fill: #7f8c8d;"/>
                    <TextField fx:id="mealTimeField" promptText="HH:MM (e.g., 12:30)"/>
                </VBox>
            </HBox>
        </VBox>

        <!-- Food Search -->
        <VBox spacing="15" VBox.vgrow="ALWAYS" style="-fx-background-color: white; -fx-padding: 20; -fx-background-radius: 10; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 10, 0, 0, 2);">
            <Label text="Search Foods" style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #2c3e50;"/>
            <TextField fx:id="foodSearchField" promptText="Search for foods..." style="-fx-font-size: 13px;"/>
            <TableView fx:id="foodsTableView" VBox.vgrow="ALWAYS" minHeight="250" prefHeight="300">
                <columns>
                    <TableColumn fx:id="foodNameColumn" text="Food Name" minWidth="150"/>
                    <TableColumn fx:id="servingSizeColumn" text="Serving" minWidth="80"/>
                    <TableColumn fx:id="caloriesColumn" text="Cal" minWidth="60"/>
                    <TableColumn fx:id="proteinColumn" text="Protein" minWidth="60"/>
                    <TableColumn fx:id="carbsColumn" text="Carbs" minWidth="60"/>
                    <TableColumn fx:id="fatsColumn" text="Fats" minWidth="60"/>
                    <TableColumn fx:id="addColumn" text="Add" minWidth="60" maxWidth="80"/>
                </columns>
                <columnResizePolicy>
                    <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
                </columnResizePolicy>
            </TableView>
        </VBox>

        <!-- Current Meal Items -->
        <VBox spacing="15" style="-fx-background-color: white; -fx-padding: 20; -fx-background-radius: 10; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 10, 0, 0, 2);">
            <Label text="Current Meal Items" style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #2c3e50;"/>
            <ScrollPane fitToWidth="true" minHeight="150" prefHeight="200" maxHeight="250" style="-fx-background-color: transparent; -fx-background: transparent;">
                <VBox fx:id="mealItemsContainer" spacing="10"/>
            </ScrollPane>
        </VBox>

        <!-- Running Totals -->
        <HBox spacing="15" style="-fx-background-color: white; -fx-padding: 20; -fx-background-radius: 10; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 10, 0, 0, 2);">
            <VBox spacing="5" alignment="CENTER" HBox.hgrow="ALWAYS" style="-fx-background-color: #fff3cd; -fx-padding: 15; -fx-background-radius: 8;">
                <Label text="Calories" style="-fx-font-size: 11px; -fx-text-fill: #856404;"/>
                <Label fx:id="totalCaloriesLabel" text="0 kcal" style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #f39c12;"/>
            </VBox>
            <VBox spacing="5" alignment="CENTER" HBox.hgrow="ALWAYS" style="-fx-background-color: #d4edda; -fx-padding: 15; -fx-background-radius: 8;">
                <Label text="Protein" style="-fx-font-size: 11px; -fx-text-fill: #155724;"/>
                <Label fx:id="totalProteinLabel" text="0 g" style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #27ae60;"/>
            </VBox>
            <VBox spacing="5" alignment="CENTER" HBox.hgrow="ALWAYS" style="-fx-background-color: #cce5ff; -fx-padding: 15; -fx-background-radius: 8;">
                <Label text="Carbs" style="-fx-font-size: 11px; -fx-text-fill: #004085;"/>
                <Label fx:id="totalCarbsLabel" text="0 g" style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #3498db;"/>
            </VBox>
            <VBox spacing="5" alignment="CENTER" HBox.hgrow="ALWAYS" style="-fx-background-color: #f8d7da; -fx-padding: 15; -fx-background-radius: 8;">
                <Label text="Fats" style="-fx-font-size: 11px; -fx-text-fill: #721c24;"/>
                <Label fx:id="totalFatsLabel" text="0 g" style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #e74c3c;"/>
            </VBox>
        </HBox>

        <!-- Notes -->
        <VBox spacing="10" style="-fx-background-color: white; -fx-padding: 20; -fx-background-radius: 10; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 10, 0, 0, 2);">
            <Label text="Notes (Optional)" style="-fx-font-size: 14px; -fx-font-weight: bold; -fx-text-fill: #2c3e50;"/>
            <TextArea fx:id="notesTextArea" promptText="Add any notes about this meal..." prefRowCount="3" maxHeight="80" wrapText="true"/>
        </VBox>

        <!-- Save Button -->
        <Button fx:id="saveMealButton" text="ðŸ’¾ Save Meal" onAction="#saveMeal" maxWidth="Infinity"
                style="-fx-background-color: linear-gradient(to bottom, #66bb6a, #4caf50); -fx-text-fill: white; -fx-font-size: 16px; -fx-font-weight: bold; -fx-padding: 15; -fx-background-radius: 8; -fx-cursor: hand; -fx-effect: dropshadow(gaussian, rgba(76,175,80,0.4), 10, 0, 0, 3);">
            <cursor><javafx.scene.Cursor fx:constant="HAND"/></cursor>
        </Button>

    </VBox>

</ScrollPane>
